# Making datras data a little more tidy




```r
# devtools::install_github("fishvice/tidyices")
library(tidyices)
library(tidyverse)

yrs <- 2017  # years
qs <- c(1)   # quarters

hh <-
  icesDatras::getDATRAS(record = "HH",
                        survey = "NS-IBTS",
                        years = yrs,
                        quarters = qs) %>%
  tidy_hauls()
glimpse(hh)
```

```
## Observations: 385
## Variables: 17
## $ id        <chr> "2017_1_ENDW_GOV_9", "2017_1_ENDW_GOV_10", "2017_1_E...
## $ survey    <chr> "NS-IBTS", "NS-IBTS", "NS-IBTS", "NS-IBTS", "NS-IBTS...
## $ year      <int> 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017...
## $ quarter   <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ ship      <chr> "ENDW", "ENDW", "ENDW", "ENDW", "ENDW", "ENDW", "END...
## $ gear      <chr> "GOV", "GOV", "GOV", "GOV", "GOV", "GOV", "GOV", "GO...
## $ haulno    <int> 9, 10, 11, 12, 15, 16, 17, 18, 19, 20, 21, 22, 23, 2...
## $ haulval   <chr> "V", "V", "V", "I", "V", "V", "V", "V", "V", "V", "V...
## $ country   <chr> "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "NO...
## $ hauldur   <int> 30, 30, 16, 30, 30, 25, 29, 29, 30, 29, 24, 29, 30, ...
## $ shootlat  <dbl> 58.5899, 58.7102, 58.4823, 58.0828, 58.0869, 58.1002...
## $ shootlong <dbl> 3.6632, 2.6974, 2.8263, 3.6115, 3.8011, 4.5014, 4.30...
## $ date      <dttm> 2017-01-25 08:23:00, 2017-01-25 12:47:00, 2017-01-2...
## $ depth     <int> 143, 111, 103, 90, 95, 127, 94, 69, 65, 65, 64, 66, ...
## $ subarea   <chr> "46F3", "46F2", "45F2", "45F3", "45F3", "45F4", "44F...
## $ daynight  <chr> "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D...
## $ datatype  <chr> "C", "C", "C", "C", "C", "C", "C", "C", "C", "C", "C...
```

```r
hl <-
  icesDatras::getDATRAS(record = "HL",
                        survey = "NS-IBTS",
                        years = yrs,
                        quarters = qs) %>%
  tidy_lengths(hh)
glimpse(hl)
```

```
## Observations: 54,709
## Variables: 6
## $ id      <chr> "2017_1_SCO3_GOV_14", "2017_1_SCO3_GOV_14", "2017_1_SC...
## $ latin   <chr> "Lophius piscatorius", "Alloteuthis subulata", "Allote...
## $ species <chr> "monk", "European common squid", "European common squi...
## $ sex     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ length  <dbl> 21, 2, 3, 4, 5, 6, 7, 8, 28, 31, 2, 3, 4, 17, 18, 19, ...
## $ n       <dbl> 2, 12, 90, 224, 146, 66, 16, 2, 2, 2, 2, 8, 2, 4, 2, 2...
```

```r
ca <-
  icesDatras::getDATRAS(record = "CA",
                        survey = "NS-IBTS",
                        years = yrs,
                        quarters = qs) %>%
  tidy_ages()
glimpse(ca)
```

```
## Observations: 32,134
## Variables: 9
## $ id       <chr> "2017_1_ENDW_GOV_10", "2017_1_ENDW_GOV_10", "2017_1_E...
## $ latin    <chr> "Melanogrammus aeglefinus", "Melanogrammus aeglefinus...
## $ species  <chr> "haddock", "haddock", "haddock", "haddock", "haddock"...
## $ length   <dbl> 37.0, 38.0, 38.0, 39.0, 45.0, 55.0, 13.0, 14.0, 15.0,...
## $ sex      <chr> NA, "F", NA, "M", "M", "M", NA, NA, NA, NA, NA, NA, N...
## $ maturity <int> NA, 62, NA, 64, 64, 64, NA, NA, NA, NA, NA, NA, NA, N...
## $ age      <int> NA, 3, NA, 4, 5, 5, NA, NA, NA, NA, NA, NA, NA, NA, N...
## $ wgt      <dbl> NA, 553, NA, 580, 956, 1607, NA, NA, NA, NA, NA, NA, ...
## $ n        <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 5, 5, 4, 4, 6, 1, 1, 1,...
```

