---
title: "Workflow example"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  warning = FALSE,
  message = FALSE
)
```

```{r setup}
# remotes::install_github("fishvice/tidyices", ref = "dev")
library(tidyices)
library(tidyverse)
```

## Get data and tidy

Note that the dr_getdata can work with multiple surveys (a loop is inside the function)

```{r}

surveys <- c("NS-IBTS", "FR-CGFS")
yrs <- 2020:2022 
qs  <- 1:4

hh <- dr_getdata("HH", surveys, yrs, qs) |> dr_tidy()
hl <- dr_getdata("HL", surveys, yrs, qs) |> dr_tidy()
ca <- dr_getdata("CA", surveys, yrs, qs) |> dr_tidy()
```

```{r}
hh |> count(survey)
hl |> count(survey)
ca |> count(survey)
```


## Species - workflow experiments

```{r}
hl |> 
  left_join(aphia_latin) |> 
  count(latin)
ca |> 
  left_join(aphia_latin) |> 
  count(latin)
```


